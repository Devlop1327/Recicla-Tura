<ion-app>
  <ion-split-pane contentId="main-content" when="(min-width: 768px)">
    <!-- Menú lateral integrado -->
    <ion-menu
      menuId="main-menu"
      contentId="main-content"
      type="overlay"
      swipeGesture="true"
    >
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="end">
            <ion-button (click)="closeMenu()">
              <ion-icon slot="icon-only" name="close-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
          <ion-title>Menú</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        <ion-list>
          <ion-item button (click)="navigateTo('home')">
            <ion-icon slot="start" name="home-outline"></ion-icon>
            <ion-label>Inicio</ion-label>
          </ion-item>

          @if (role() === 'admin') {
            <ion-item button (click)="navigateTo('vehicles')">
              <ion-icon slot="start" name="car-outline"></ion-icon>
              <ion-label>Vehículos</ion-label>
            </ion-item>
          }

          <ion-item button (click)="navigateTo('notifications')">
            <ion-icon slot="start" name="notifications-outline"></ion-icon>
            <ion-label>Notificaciones</ion-label>
            @if (unreadNotifications > 0) {
              <ion-badge slot="end" color="danger">
                {{ unreadNotifications }}
              </ion-badge>
            }
          </ion-item>

          <ion-item button (click)="navigateTo('profile')">
            <ion-icon slot="start" name="person-outline"></ion-icon>
            <ion-label>Perfil</ion-label>
          </ion-item>

          <ion-item button (click)="logout()">
            <ion-icon slot="start" name="log-out-outline"></ion-icon>
            <ion-label>Cerrar Sesión</ion-label>
          </ion-item>
        </ion-list>
      </ion-content>
    </ion-menu>

    <!-- Contenido principal -->
    <div class="ion-page" id="main-content">
      <ion-header [translucent]="true">
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
          </ion-buttons>
          <ion-title>{{ currentTitle }}</ion-title>
          @if (role()) {
            <ion-badge slot="end" [color]="role() === 'admin' ? 'tertiary' : (role() === 'conductor' ? 'success' : 'medium')" style="margin-right:12px; text-transform: capitalize;">
              {{ role() }}
            </ion-badge>
          }
        </ion-toolbar>
      </ion-header>

      <ion-content [fullscreen]="true">
        <ion-tabs>
          <ion-tab-bar slot="bottom">
            <ion-tab-button
              tab="home"
              (click)="updateTitle('Inicio')"
              (ionSelect)="updateTitle('Inicio')"
            >
              <ion-icon name="home-outline"></ion-icon>
              <ion-label>Inicio</ion-label>
            </ion-tab-button>

            @if (role() === 'admin') {
              <ion-tab-button
                tab="vehicles"
                (click)="updateTitle('Vehículos')"
                (ionSelect)="updateTitle('Vehículos')"
              >
                <ion-icon name="car-outline"></ion-icon>
                <ion-label>Vehículos</ion-label>
              </ion-tab-button>
            }

            <ion-tab-button
              tab="notifications"
              (click)="updateTitle('Notificaciones')"
              (ionSelect)="updateTitle('Notificaciones')"
            >
              <ion-icon name="notifications-outline"></ion-icon>
              <ion-label>Notificaciones</ion-label>
               @if (unreadNotifications > 0) {
                <ion-badge color="danger">{{ unreadNotifications }}</ion-badge>
              }
            </ion-tab-button>

            <ion-tab-button
              tab="profile"
              (click)="updateTitle('Perfil')"
              (ionSelect)="updateTitle('Perfil')"
            >
              <ion-icon name="person-outline"></ion-icon>
              <ion-label>Perfil</ion-label>
            </ion-tab-button>
          </ion-tab-bar>

          <router-outlet></router-outlet>
        </ion-tabs>
      </ion-content>
    </div>
  </ion-split-pane>
</ion-app>
