 <ion-content>
  <ion-grid class="profile-container">
    <!-- Header con avatar -->
    <ion-row class="header-section">
      <ion-col size="12">
        <ion-card>
          <ion-card-content>
            <ion-row class="profile-header" align-items-center>
              <ion-col class="avatar-section" size="auto">
                <ion-avatar class="profile-avatar">
                  @if (profile()?.avatar_url) {
                    <ion-img [src]="profile()!.avatar_url" alt="Avatar"></ion-img>
                  } @else {
                    <ion-icon name="person" size="large"></ion-icon>
                  }
                </ion-avatar>
                <ion-row class="avatar-upload ion-margin-top">
                  <ion-col size="12">
                    <ion-button size="small" (click)="uploadAvatar()" [disabled]="isLoading()">
                      Subir Avatar
                    </ion-button>
                  </ion-col>
                </ion-row>
              </ion-col>
              <ion-col class="avatar-info">
                <ion-text>{{ profile()?.full_name || 'Usuario' }}</ion-text>
                <ion-text color="medium">{{ profile()?.email }}</ion-text>
                <ion-badge color="primary">Activo</ion-badge>
              </ion-col>
              <ion-col class="header-actions" size="auto">
                <ion-button 
                  fill="clear" 
                  size="small" 
                  (click)="toggleEdit()">
                  <ion-icon name="create" slot="icon-only"></ion-icon>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>

    <!-- Información del perfil -->
    <ion-row class="info-section">
      <ion-col size="12">
      <ion-card>
        <ion-card-header>
          <ion-card-title>📋 Información Personal</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          @if (isLoading()) {
            <ion-row class="loading-container" justify-content-center>
              <ion-col size="12" class="ion-text-center">
                <ion-spinner name="crescent"></ion-spinner>
                <ion-text class="ion-margin-start">Cargando perfil...</ion-text>
              </ion-col>
            </ion-row>
          } @else {
            <ion-list class="info-form">
              <ion-item>
                <ion-label position="stacked">Nombre Completo</ion-label>
                @if (isEditing()) {
                  <ion-input 
                    [value]="fullName()" 
                    (ionInput)="fullName.set($event.detail.value!)"
                    placeholder="Tu nombre completo">
                  </ion-input>
                } @else {
                  <ion-text>{{ profile()?.full_name || 'No especificado' }}</ion-text>
                }
              </ion-item>

              <ion-item>
                <ion-label position="stacked">Teléfono</ion-label>
                @if (isEditing()) {
                  <ion-input 
                    type="tel"
                    [value]="phone()" 
                    (ionInput)="phone.set($event.detail.value!)"
                    placeholder="Tu número de teléfono">
                  </ion-input>
                } @else {
                  <ion-text>{{ profile()?.phone || 'No especificado' }}</ion-text>
                }
              </ion-item>

              <ion-item>
                <ion-label position="stacked">Dirección</ion-label>
                @if (isEditing()) {
                  <ion-textarea 
                    [value]="address()" 
                    (ionInput)="address.set($event.detail.value!)"
                    placeholder="Tu dirección en Buenaventura"
                    rows="3">
                  </ion-textarea>
                } @else {
                  <ion-text>{{ profile()?.address || 'No especificada' }}</ion-text>
                }
              </ion-item>

              <ion-item>
                <ion-label position="stacked">Email</ion-label>
                <ion-text color="medium">{{ profile()?.email }}</ion-text>
              </ion-item>

              <ion-item>
                <ion-label position="stacked">Miembro desde</ion-label>
                <ion-text color="medium">
                  {{ getFechaCreacion() }}
                </ion-text>
              </ion-item>
            </ion-list>

            @if (isEditing()) {
              <ion-row class="form-actions">
                <ion-col size="12">
                  <ion-button 
                    fill="outline" 
                    color="medium" 
                    (click)="toggleEdit()">
                    Cancelar
                  </ion-button>
                  <ion-button 
                    color="primary" 
                    (click)="saveProfile()">
                    Guardar
                  </ion-button>
                </ion-col>
              </ion-row>
            }
          }
        </ion-card-content>
      </ion-card>
      </ion-col>
    </ion-row>

    <!-- Estadísticas -->
    <ion-row class="stats-section">
      <ion-col size="12">
      <ion-card>
        <ion-card-header>
          <ion-card-title>📊 Estadísticas</ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-row class="stats-grid">
            <ion-col class="stat-item" size="12">
              <ion-icon name="notifications" color="primary"></ion-icon>
              <ion-col class="stat-info">
                <ion-text>12</ion-text>
                <ion-text color="medium">Notificaciones</ion-text>
              </ion-col>
            </ion-col>
            <ion-col class="stat-item" size="12">
              <ion-icon name="time" color="success"></ion-icon>
              <ion-col class="stat-info">
                <ion-text>5</ion-text>
                <ion-text color="medium">Días activo</ion-text>
              </ion-col>
            </ion-col>
            <ion-col class="stat-item" size="12">
              <ion-icon name="location" color="warning"></ion-icon>
              <ion-col class="stat-info">
                <ion-text>3</ion-text>
                <ion-text color="medium">Rutas seguidas</ion-text>
              </ion-col>
            </ion-col>
          </ion-row>
        </ion-card-content>
      </ion-card>
      </ion-col>
    </ion-row>

    <!-- Acciones -->
    <ion-row class="actions-section">
      <ion-col size="12">
      <ion-card>
        <ion-card-content>
          <ion-row class="action-buttons">
            <ion-col size="12">
              <ion-button 
                expand="block" 
                fill="outline" 
                color="medium"
                (click)="signOut()">
                <ion-icon name="log-out" slot="start"></ion-icon>
                Cerrar Sesión
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-card-content>
      </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>

